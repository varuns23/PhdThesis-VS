#!/usr/bin/env python
import sys, os, subprocess, string, re
from ROOT import *
from array import array


gROOT.SetBatch(kTRUE);
gStyle.SetOptStat(0)
gStyle.SetOptTitle(0)
gStyle.SetTitleFont(42, "XYZ")
gStyle.SetTitleSize(0.05, "XYZ")
gStyle.SetLabelFont(42, "XYZ")
gStyle.SetLabelSize(0.05, "XYZ")
gStyle.SetCanvasBorderMode(0)
gStyle.SetFrameBorderMode(0)
gStyle.SetCanvasColor(kWhite)
gStyle.SetPadTickX(1)
gStyle.SetPadTickY(1)
gStyle.SetPadLeftMargin(0.15)
gStyle.SetPadRightMargin(0.05)
gStyle.SetPadTopMargin(0.05)
gStyle.SetPadBottomMargin(0.15)
gROOT.ForceStyle()


BR = 1.0



#masses = array('d', [700.0, 800.0, 900.0, 1000.0, 1100.0, 1200.0, 1300.0, 1400.0, 1500.0, 1600.0, 1700.0, 1800.0, 1900.0, 2000.0, 2100.0, 2200.0, 2300.0, 2400.0, 2500.0, 2600.0, 2700.0, 2800.0, 2900.0, 3000.0, 3100.0, 3200.0, 3300.0, 3400.0, 3500.0, 3600.0, 3700.0, 3800.0, 3900.0, 4000.0, 4100.0, 4200.0, 4300.0, 4400.0])

masses = array('d', [0.7, 0.8, 0.9, 1.0,1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1 ,3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4.0, 4.1, 4.2, 4.3, 4.4 ])

xs_obs_limits  = array('d', [0.020306299999999999, 0.023294200000000001, 0.0124058, 0.0078980700000000001, 0.0073568000000000001, 0.0078870199999999998, 0.0069746299999999999, 0.0052076099999999997, 0.0046997499999999999, 0.0033775799999999998, 0.00158775, 0.00102687, 0.00120776, 0.00138119, 0.00165193, 0.00160016, 0.0012200500000000001, 0.00090929100000000001, 0.00073941000000000002, 0.00056088000000000004, 0.00041895799999999998, 0.00036362500000000002, 0.00038557000000000001, 0.00037073899999999998, 0.00031664300000000002, 0.00026156900000000002, 0.00022206999999999999, 0.000201898, 0.00020829999999999999, 0.000200948, 0.000195262, 0.00018602399999999999, 0.000182676, 0.00019682799999999999, 0.000193661, 0.000190798, 0.00018821899999999999, 0.000191218])

xs_exp_limits = array('d', [0.032447200000000002, 0.0205948, 0.0149041, 0.0103874, 0.0076942199999999999, 0.00640283, 0.0054639099999999998, 0.0044302999999999999, 0.00334352, 0.0029254699999999999, 0.00232592, 0.00183932, 0.0015794100000000001, 0.00130755, 0.0010592100000000001, 0.00087542900000000005, 0.00079305599999999999, 0.00071007000000000004, 0.00062135000000000001, 0.00053790000000000001, 0.00051442100000000004, 0.00044905999999999999, 0.00042217699999999998, 0.00038216699999999999, 0.00037031500000000002, 0.00031859500000000002, 0.00029838299999999999, 0.00029160699999999999, 0.00027965999999999999, 0.00027139200000000002, 0.000255966, 0.00024712699999999998, 0.00023958900000000001, 0.00025110200000000001, 0.00024496300000000001, 0.000238197, 0.00023408700000000001, 0.00022724900000000001])

masses_exp = array('d', [700.0, 800.0, 900.0, 1000.0, 1100.0, 1200.0, 1300.0, 1400.0, 1500.0, 1600.0, 1700.0, 1800.0, 1900.0, 2000.0, 2100.0, 2200.0, 2300.0, 2400.0, 2500.0, 2600.0, 2700.0, 2800.0, 2900.0, 3000.0, 3100.0, 3200.0, 3300.0, 3400.0, 3500.0, 3600.0, 3700.0, 3800.0, 3900.0, 4000.0, 4100.0, 4200.0, 4300.0, 4400.0, 4400.0, 4300.0, 4200.0, 4100.0, 4000.0, 3900.0, 3800.0, 3700.0, 3600.0, 3500.0, 3400.0, 3300.0, 3200.0, 3100.0, 3000.0, 2900.0, 2800.0, 2700.0, 2600.0, 2500.0, 2400.0, 2300.0, 2200.0, 2100.0, 2000.0, 1900.0, 1800.0, 1700.0, 1600.0, 1500.0, 1400.0, 1300.0, 1200.0, 1100.0, 1000.0, 900.0, 800.0, 700.0])
xs_exp_limits_1sigma  = array('d', [0.023815900000000001, 0.015186699999999999, 0.0107262, 0.0073235499999999999, 0.0055503699999999998, 0.0044829199999999996, 0.0037374700000000001, 0.00315563, 0.0024073699999999998, 0.0020301400000000002, 0.00169118, 0.00130568, 0.0011190900000000001, 0.00093222599999999997, 0.00079098099999999995, 0.00065530700000000005, 0.00059509999999999999, 0.00049798699999999997, 0.000444258, 0.000429202, 0.00039746300000000003, 0.00033208599999999999, 0.000308468, 0.00028787499999999999, 0.00026916700000000001, 0.00024058700000000001, 0.00022728700000000001, 0.000219466, 0.00021501199999999999, 0.00020820800000000001, 0.00020429399999999999, 0.00019594400000000001, 0.00019058200000000001, 0.00020948900000000001, 0.00020410099999999999, 0.000199392, 0.00019697399999999999, 0.00019554800000000001, 0.00028758700000000001, 0.00029307500000000001, 0.000313846, 0.00033147599999999998, 0.00033713100000000001, 0.00030632199999999999, 0.000327697, 0.00033798699999999999, 0.00034909699999999998, 0.000383707, 0.00041167899999999997, 0.00042459699999999997, 0.00044298599999999998, 0.00049099899999999999, 0.00052153799999999999, 0.00063385199999999996, 0.00062557599999999997, 0.00074943600000000003, 0.00076432699999999998, 0.000846815, 0.00093320800000000004, 0.0011071200000000001, 0.0012421699999999999, 0.00144805, 0.00187072, 0.00217812, 0.00262452, 0.0031587500000000001, 0.0041205800000000004, 0.0045869500000000002, 0.0061339300000000001, 0.0073051499999999998, 0.0091291299999999992, 0.0112567, 0.0144371, 0.020596300000000001, 0.028091499999999998, 0.045379500000000003])
xs_exp_limits_2sigma = array('d', [0.017819399999999999, 0.012333800000000001, 0.0072213700000000004, 0.0059302499999999998, 0.00395883, 0.0034685800000000002, 0.0031724100000000001, 0.0022495900000000001, 0.00183398, 0.0016962500000000001, 0.00126691, 0.000963903, 0.000908423, 0.00067648999999999997, 0.00058845200000000005, 0.00051769800000000003, 0.00047896700000000001, 0.00039562000000000001, 0.00036454599999999999, 0.000323796, 0.00028944799999999998, 0.000255994, 0.00023796399999999999, 0.000237834, 0.00022204399999999999, 0.000202289, 0.000194143, 0.00019163200000000001, 0.000193678, 0.00018418699999999999, 0.00018411600000000001, 0.00018189899999999999, 0.000176448, 0.00019213800000000001, 0.000187486, 0.00019017, 0.00018795500000000001, 0.000183444, 0.00040349199999999998, 0.00041051899999999998, 0.00045657899999999998, 0.000460278, 0.00046689000000000002, 0.000401004, 0.000421696, 0.00041975500000000001, 0.00045636199999999998, 0.00047193300000000001, 0.00053620600000000001, 0.00053054299999999997, 0.00060762999999999995, 0.00065961199999999996, 0.00074494899999999996, 0.00078884300000000001, 0.00088334700000000004, 0.00109377, 0.0010987, 0.0011753, 0.00124912, 0.00144903, 0.00163558, 0.0020059499999999998, 0.0024302799999999999, 0.0029095900000000001, 0.0031596100000000002, 0.0040986599999999996, 0.0054680299999999996, 0.0058653000000000004, 0.0076734500000000001, 0.0097429000000000005, 0.011803599999999999, 0.014805499999999999, 0.018382699999999998, 0.028469999999999999, 0.039132199999999999, 0.057865100000000003])





###---------Belwo the 1TeV and 2.5 TeV points are interpolated mass points instead of Generated one

masses_IP = array('d', [1.0, 2.5])

xs_obs_limits_IP  = array('d', [0.00768853000, 0.0007206630000000])
xs_exp_limits_IP = array('d',  [0.0103874, 0.00062135000000000001])

#xs_obs_limits_IP  = array('d', [0.020306299999999999, 0.023294200000000001, 0.0124058, 0.0078980700000000001, 0.0073568000000000001, 0.0078870199999999998, 0.0069746299999999999, 0.0052076099999999997, 0.0046997499999999999, 0.0033775799999999998, 0.00158775, 0.00102687, 0.00120776, 0.00138119, 0.00165193, 0.00160016, 0.0012200500000000001, 0.00090929100000000001, 0.0007206630000000, 0.00056088000000000004, 0.00041895799999999998, 0.00036362500000000002, 0.00038557000000000001, 0.00037073899999999998, 0.00031664300000000002, 0.00026156900000000002, 0.00022206999999999999, 0.000201898, 0.00020829999999999999, 0.000200948, 0.000195262, 0.00018602399999999999, 0.000182676, 0.00019682799999999999, 0.000193661, 0.000190798, 0.00018821899999999999, 0.000191218])
                                                                                                                             
#xs_exp_limits_IP = array('d', [0.032447200000000002, 0.0205948, 0.0149041, 0.0103874, 0.0076942199999999999, 0.00640283, 0.0054639099999999998, 0.0044302999999999999, 0.00334352, 0.0029254699999999999, 0.00232592, 0.00183932, 0.0015794100000000001, 0.00130755, 0.0010592100000000001, 0.00087542900000000005, 0.00079305599999999999, 0.00071007000000000004, 0.00062135000000000001, 0.00053790000000000001, 0.00051442100000000004, 0.00044905999999999999, 0.00042217699999999998, 0.00038216699999999999, 0.00037031500000000002, 0.00031859500000000002, 0.00029838299999999999, 0.00029160699999999999, 0.00027965999999999999, 0.00027139200000000002, 0.000255966, 0.00024712699999999998, 0.00023958900000000001, 0.00025110200000000001, 0.00024496300000000001, 0.000238197, 0.00023408700000000001, 0.00022724900000000001])





masses_qstar = array('d', [ 1.5, 1.7, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5])
## cross seciton
xs_qstar = array ('d',[0.4124, 0.1843, 0.05858, 0.009768, 0.001755, 3.241e-04, 6.045e-05, 1.170e-05 ])
eff_qstar_5a = array ('d', [0.508658,  0.509517, 0.514875, 0.516033, 0.514827, 0.512049, 0.501099,  0.484778])

xs_5a = array('d', [float(b) * float(m) for b,m in zip(xs_qstar, eff_qstar_5a)])


result= array('d',[0.7,0.8,0.9,1.0,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4.0,4.1,4.2,4.3,4.4,4.4,4.3,4.2,4.1,4.0,3.9,3.8,3.7,3.6,3.5,3.4,3.3,3.2,3.1,3.0,2.9,2.8,2.7,2.6,2.5,2.4,2.3,2.2,2.1,2.0,1.9,1.8,1.7,1.6,1.5,1.4,1.3,1.2,1.1,1.0,0.9,0.8,0.7])




graph_exp_2sigma = TGraph(len(masses_exp),result,xs_exp_limits_2sigma)
graph_exp_2sigma.SetFillColor(kYellow)
graph_exp_2sigma.GetYaxis().SetTitle("#sigma#timesA#times#epsilon [pb]")
graph_exp_2sigma.GetYaxis().CenterTitle()
graph_exp_2sigma.GetYaxis().SetRangeUser(1e-05,0.3)
graph_exp_2sigma.GetYaxis().SetLabelSize(0.04)
graph_exp_2sigma.GetYaxis().SetTitleOffset(1.1)

graph_exp_2sigma.GetXaxis().SetTitle("q* Mass [TeV]")
graph_exp_2sigma.GetXaxis().CenterTitle()
graph_exp_2sigma.GetXaxis().SetLabelSize(0.04)
graph_exp_2sigma.GetXaxis().SetTitleOffset(1.1)     
graph_exp_2sigma.GetXaxis().SetNdivisions(510)


graph_exp_1sigma = TGraph(len(masses_exp),result,xs_exp_limits_1sigma)
graph_exp_1sigma.SetFillColor(kGreen+1)

graph_exp = TGraph(len(masses),masses,xs_exp_limits)
#graph_exp.SetMarkerStyle(24)
graph_exp.SetLineWidth(2)
graph_exp.SetLineStyle(2)
graph_exp.SetLineColor(4)

graph_obs = TGraph(len(masses),masses,xs_obs_limits)
graph_obs.SetMarkerStyle(20)
graph_obs.SetLineWidth(2)
#graph_obs.SetLineStyle(1)
graph_obs.SetLineColor(1)

graph_qstar = TGraph(len(masses_qstar),masses_qstar,xs_5a)
graph_qstar.SetLineWidth(2)                
graph_qstar.SetLineColor(2)



graph_exp_ip = TGraph(len(masses_IP),masses_IP,xs_exp_limits_IP)
#graph_exp_ip.SetMarkerStyle(24)
graph_exp_ip.SetLineWidth(2)
graph_exp_ip.SetLineStyle(2)
graph_exp_ip.SetLineColor(2)
 
graph_obs_ip = TGraph(len(masses_IP),masses_IP,xs_obs_limits_IP)
graph_obs_ip.SetMarkerStyle(21)
graph_obs_ip.SetMarkerColor(2)
graph_obs_ip.SetLineWidth(2)
#graph_obs.SetLineStyle(1)
graph_obs_ip.SetLineColor(2)




c = TCanvas("c", "",800,800)
c.cd()

graph_exp_2sigma.Draw("AF")
graph_exp_1sigma.Draw("F")
graph_exp.Draw("L")
graph_obs.Draw("LP")
#graph_exp_ip.Draw("L")
graph_obs_ip.Draw("P")
graph_qstar.Draw("L")

legend = TLegend(.55,.72,.85,.95)
legend.SetBorderSize(0)
legend.SetFillColor(0)
legend.SetFillStyle(0)
legend.SetTextFont(42)
legend.SetTextSize(0.03)
legend.SetHeader('95% CL Upper Limits')
legend.AddEntry(graph_obs,"Observed Gen","lp")
legend.AddEntry(graph_exp,"Expected Gen","lp")
legend.AddEntry(graph_qstar,"Excited Quark","l")
legend.AddEntry(graph_obs_ip,"Observed IP","lp")
legend.AddEntry(graph_exp_ip,"Expected IP","lp")
legend.Draw()

l1 = TLatex()
l1.SetTextAlign(12)
l1.SetTextFont(42)
l1.SetNDC()
l1.SetTextSize(0.04)
l1.SetTextSize(0.03)
l1.DrawLatex(0.19,0.45, "CMS Preliminary")
l1.DrawLatex(0.19,0.36, "#intLdt = 19.7 fb^{-1}")
l1.DrawLatex(0.19,0.31, "#sqrt{s} = 8 TeV")
l1.SetTextSize(0.04)

gPad.RedrawAxis();

c.SetLogy()
c.SaveAs('GenVsIP_1TeV_2p5TeV_LowPt170_LowM500GeV_dEta1p6_ObseExp_Limits_qstar_full_v2.pdf')

